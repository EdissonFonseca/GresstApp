<!-- Header section with navigation and actions -->
<ion-header>
  <!-- Main toolbar with navigation and action buttons -->
  <ion-toolbar class="header-green">
    <!-- Back button for navigation -->
    <ion-buttons slot="start">
      <ion-back-button (click)="goBack()" text=""></ion-back-button>
    </ion-buttons>

    <!-- Page title showing current activity -->
    <ion-title color="light">
      {{ activity().title }}
    </ion-title>

    <!-- Action buttons for data synchronization -->
    <ion-buttons slot="end">
      <ion-button
        (click)="synchronize()"
        [disabled]="isSynchronizing">
        <ion-icon
          slot="icon-only"
          name="sync"
          [class.rotating]="isSynchronizing">
        </ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>

  <!-- Search toolbar for filtering tasks -->
  <ion-toolbar>
    <ion-searchbar
      (ionInput)="handleInput($event)"
      [placeholder]="'TASKS.SEARCH' | translate"
      show-clear-button="focus"
      aria-label="Search tasks">
    </ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" color="light">
  <div class="content-wrapper">
    <!-- Transactions and tasks list container -->
    <ng-container *ngIf="transactions() | async as transactionCards">
      <ng-container *ngFor="let transaction of transactionCards">
        <!-- Transaction title -->
        <div class="card-container">
          <ion-item lines="none" class="transparent-item">
            <ion-label>
              <h2>{{ transaction.title }}</h2>
              <p>{{ transaction.summary }}</p>
            </ion-label>
          </ion-item>

          <!-- Tasks list for current transaction -->
          <app-card-list
            [cards]="filterTasks(transaction.id)"
            (edit)="openEditTask($event)"
            [showEdit]="true"
            aria-label="Lista de tareas"
            role="list">
          </app-card-list>
        </div>
      </ng-container>
    </ng-container>
  </div>
</ion-content>

<!-- Floating action button for adding new tasks -->
<ion-fab
  slot="fixed"
  vertical="bottom"
  horizontal="end"
  *ngIf="showAdd"
  aria-label="Add new task">
  <ion-fab-button
    (click)="openAddTask()"
    aria-label="Add icon">
    <ion-icon
      name="add"
      aria-hidden="true">
    </ion-icon>
  </ion-fab-button>
</ion-fab>
